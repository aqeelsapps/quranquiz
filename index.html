<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>Qur'an Trivia ‚Äì 100 Questions</title>
  <meta name="description" content="Child‚Äëfriendly multiple‚Äëchoice Qur'an quiz (100 questions) with instant feedback and final score." />
  <style>
    :root{
      --bg:#f9fafb; /* light */
      --card:#ffffff;
      --text:#111827; /* slate-900 */
      --sub:#4b5563; /* slate-600 */
      --brand:#2563eb; /* blue-600 */
      --brand-2:#22c55e; /* green-500 */
      --muted:#e5e7eb; /* slate-200 */
      --wrong:#ef4444; /* red-500 */
      --right:#16a34a; /* green-600 */
      --shadow: 0 10px 25px rgba(0,0,0,.08);
      --radius: 18px;
    }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";}
    .wrap{max-width:960px;margin:0 auto;padding:20px 16px 60px;}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;}
    .title{font-size: clamp(22px, 4vw, 34px);font-weight:800;letter-spacing:.2px;margin:0;}
    .subtitle{margin:.4rem 0 1rem;color:var(--sub);}
    .progress{height:12px;background:var(--muted);border-radius:999px;overflow:hidden}
    .bar{height:100%;background:linear-gradient(90deg,var(--brand),#7c3aed);width:0%;transition:width .5s ease}
    .qno{font-weight:700;opacity:.85;margin-bottom:8px}
    .question{font-size: clamp(18px, 3.4vw, 24px);font-weight:700;line-height:1.25;margin:10px 0 14px}
    .choices{display:grid;gap:10px}
    @media(min-width:640px){.choices{grid-template-columns:1fr 1fr}}
    .choice{border:2px solid var(--muted);background:#fff;border-radius:16px;padding:14px 16px;display:flex;gap:12px;align-items:center;cursor:pointer;transition:transform .06s ease, border-color .2s ease, box-shadow .2s ease}
    .choice:hover{transform:translateY(-1px);box-shadow:0 10px 16px rgba(0,0,0,.06)}
    .label{font-weight:800;min-width:28px;height:28px;display:grid;place-items:center;border-radius:10px;background:var(--muted)}
    .choice.correct{border-color:var(--right);}
    .choice.wrong{border-color:var(--wrong);}
    .choice.disabled{opacity:.75;cursor:not-allowed}
    .badge{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;font-weight:800;margin:8px 0}
    .badge.right{background:rgba(22,163,74,.1);color:var(--right)}
    .badge.wrong{background:rgba(239,68,68,.1);color:var(--wrong)}
    .answerline{margin-top:8px;color:#065f46;font-weight:700}
    .ref{color:var(--sub);font-size:14px;margin-top:4px}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .btn{background:var(--text);color:#fff;border:none;border-radius:14px;padding:12px 16px;font-weight:800;cursor:pointer;box-shadow:var(--shadow);}
    .btn:disabled{opacity:.4;cursor:not-allowed}
    .btn.primary{background:var(--brand)}
    .btn.ghost{background:#fff;border:2px solid var(--muted);color:var(--text)}
    .btn.success{background:var(--brand-2)}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;border:2px dashed var(--muted);}
    .footer{margin-top:14px;color:var(--sub);font-size:13px}
    .score{font-size: clamp(24px,4vw,42px);font-weight:900;margin:8px 0}
    .grid{display:grid;gap:12px}
    .review{border-left:6px solid var(--muted);padding-left:12px}
    .correctText{color:var(--right)}
    .wrongText{color:var(--wrong)}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
    .tiny{font-size:12px;color:var(--sub)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="topbar">
        <div>
          <h1 class="title">Qur'an Trivia</h1>
          <div class="subtitle">100 multiple‚Äëchoice questions ‚Ä¢ child‚Äëfriendly ‚Ä¢ instant feedback</div>
        </div>
        <button class="btn ghost" id="resetBtn" aria-label="Reset quiz">‚Ü∫ Reset</button>
      </div>
      <div class="progress" aria-label="Progress"><div class="bar" id="bar"></div></div>
      <div class="pill" style="margin-top:12px" id="pill">
        <span id="progressText">Question 1 / 100</span>
      </div>

      <div id="quiz" style="margin-top:14px"></div>

      <div class="footer">Tip: Big, friendly buttons for little thumbs üòä Works offline after first load. Your progress is saved on this device.</div>
    </div>
  </div>

<script src="questions.js"></script>
<script>
// --- Data: 100 questions ---
// Each item: {q, options[4], answer (0-3), ref}
// Dataset is defined in questions.js and exposed as a global `QUESTIONS` array.

// --- State & helpers ---
const state = {
  i: 0,
  answers: Array(QUESTIONS.length).fill(null), // chosen index or null
  score: 0
};

const $ = sel => document.querySelector(sel);
const quizEl = $('#quiz');
const barEl = $('#bar');
const progressText = $('#progressText');
const resetBtn = $('#resetBtn');

// Persist state in localStorage
function save(){
  localStorage.setItem('quran_quiz_state', JSON.stringify(state));
}
function load(){
  const raw = localStorage.getItem('quran_quiz_state');
  if(!raw) return;
  try{
    const obj = JSON.parse(raw);
    if(Array.isArray(obj.answers) && typeof obj.i === 'number' && typeof obj.score === 'number'){
      state.i = Math.min(Math.max(0, obj.i), QUESTIONS.length-1);
      state.answers = obj.answers.slice(0, QUESTIONS.length);
      state.score = obj.score|0;
    }
  }catch{ /* ignore */ }
}

resetBtn.addEventListener('click', ()=>{
  if(!confirm('Start over? Your progress will be cleared.')) return;
  state.i = 0; state.answers = Array(QUESTIONS.length).fill(null); state.score = 0; save(); render();
});

function render(){
  const total = QUESTIONS.length;
  const q = QUESTIONS[state.i];
  const chosen = state.answers[state.i];

  // progress
  const percent = ((state.i)/ (total)) * 100;
  barEl.style.width = `${Math.max(4, percent)}%`;
  progressText.textContent = `Question ${state.i+1} / ${total}`;

  // question card
  quizEl.innerHTML = '';
  const qno = document.createElement('div'); qno.className='qno'; qno.textContent = `Q${state.i+1}`;
  const qt = document.createElement('div'); qt.className='question'; qt.textContent = q.q;

  const choices = document.createElement('div'); choices.className='choices';
  q.options.forEach((opt, idx)=>{
    const btn = document.createElement('button');
    btn.className = 'choice'; btn.type='button'; btn.setAttribute('aria-pressed','false');
    if(chosen!==null){ btn.classList.add('disabled'); }

    const label = document.createElement('div'); label.className='label'; label.textContent= String.fromCharCode(65+idx);
    const span = document.createElement('div'); span.style.fontWeight='700'; span.style.lineHeight='1.25'; span.textContent = opt;
    btn.appendChild(label); btn.appendChild(span);

    if(chosen!==null){
      if(idx === q.answer) btn.classList.add('correct');
      if(idx === chosen && chosen !== q.answer) btn.classList.add('wrong');
    }

    btn.addEventListener('click', ()=> onChoose(idx));
    choices.appendChild(btn);
  });

  quizEl.appendChild(qno);
  quizEl.appendChild(qt);
  quizEl.appendChild(choices);

  // feedback
  const fb = document.createElement('div');
  if(chosen!==null){
    const right = chosen === q.answer;
    const badge = document.createElement('div');
    badge.className = 'badge ' + (right? 'right':'wrong');
    badge.innerHTML = right ? '‚úÖ Correct!' : '‚ùå Not quite';
    fb.appendChild(badge);

    const answerLine = document.createElement('div');
    const correctText = `${String.fromCharCode(65+q.answer)}. ${q.options[q.answer]}`;
    answerLine.className = 'answerline';
    answerLine.innerHTML = `Correct answer: <span class="correctText">${correctText}</span>`;
    fb.appendChild(answerLine);

    if(q.ref){
      const ref = document.createElement('div'); ref.className='ref'; ref.textContent = `Ref: ${q.ref}`; fb.appendChild(ref);
    }
  } else {
    const hint = document.createElement('div'); hint.className='tiny'; hint.textContent = 'Tap an option to check your answer.'; fb.appendChild(hint);
  }
  quizEl.appendChild(fb);

  const row = document.createElement('div'); row.className='row';
  const prev = document.createElement('button'); prev.className='btn ghost'; prev.textContent='‚óÄ Previous'; prev.disabled = state.i===0; prev.onclick=()=>{state.i--; save(); render();};
  const next = document.createElement('button'); next.className='btn primary'; next.textContent = (state.i === total-1 ? 'See results ‚ñ∂' : 'Next ‚ñ∂'); next.disabled = (chosen===null); next.onclick=()=>{
    if(state.i === total-1){ showResults(); } else { state.i++; save(); render(); }
  };
  row.appendChild(prev); row.appendChild(next);
  quizEl.appendChild(row);
}

function onChoose(idx){
  const q = QUESTIONS[state.i];
  if(state.answers[state.i]!==null) return; // already answered
  state.answers[state.i] = idx;
  if(idx === q.answer) state.score++;
  save();
  render(); // re-render to show feedback
}

function showResults(){
  const total = QUESTIONS.length;
  const correct = state.score;
  const wrong = total - correct;
  const pct = Math.round((correct/total)*100);

  // build results view
  quizEl.innerHTML = '';
  const h = document.createElement('div'); h.className='score'; h.textContent = `Your score: ${correct} / ${total} (${pct}%)`;
  const sub = document.createElement('div'); sub.className='subtitle'; sub.innerHTML = (pct>=80? 'Awesome job! üèÜ':'Nice effort! Keep practising. üåü');

  // quick summary bars
  const bars = document.createElement('div'); bars.className='row';
  const good = document.createElement('div'); good.className='badge right'; good.textContent = `‚úîÔ∏è Correct: ${correct}`;
  const bad = document.createElement('div'); bad.className='badge wrong'; bad.textContent = `‚úñÔ∏è Incorrect: ${wrong}`;
  bars.appendChild(good); bars.appendChild(bad);

  const again = document.createElement('button'); again.className='btn success'; again.textContent='Play again';
  again.onclick = ()=>{ state.i=0; state.answers = Array(total).fill(null); state.score=0; save(); render(); };

  quizEl.appendChild(h); quizEl.appendChild(sub); quizEl.appendChild(bars);

  // Review list of mistakes
  const mistakes = state.answers.map((a,i)=>({i, a, q:QUESTIONS[i]})).filter(x=>x.a !== x.q.answer);
  if(mistakes.length){
    const h2 = document.createElement('div'); h2.style.fontWeight='900'; h2.style.marginTop='16px'; h2.textContent = 'Review your tricky ones:';
    quizEl.appendChild(h2);
    const grid = document.createElement('div'); grid.className='grid';
    mistakes.forEach(m=>{
      const c = document.createElement('div'); c.className='card review';
      const tt = document.createElement('div'); tt.style.fontWeight='800'; tt.style.marginBottom='6px'; tt.textContent = `Q${m.i+1}. ${m.q.q}`;
      const you = document.createElement('div'); you.className='wrongText'; you.textContent = `Your answer: ${m.a===null? '‚Äî' : String.fromCharCode(65+m.a)+'. '+m.q.options[m.a]}`;
      const cor = document.createElement('div'); cor.className='correctText'; cor.textContent = `Correct: ${String.fromCharCode(65+m.q.answer)}. ${m.q.options[m.q.answer]}`;
      c.appendChild(tt); c.appendChild(you); c.appendChild(cor);
      if(m.q.ref){ const r=document.createElement('div'); r.className='ref'; r.textContent='Ref: '+m.q.ref; c.appendChild(r);}
      grid.appendChild(c);
    });
    quizEl.appendChild(grid);
  }

  const row = document.createElement('div'); row.className='row'; row.style.marginTop='16px';
  const prevBtn = document.createElement('button'); prevBtn.className='btn ghost'; prevBtn.textContent='Back to last question'; prevBtn.onclick=()=>{ state.i = QUESTIONS.length-1; save(); render(); };
  row.appendChild(again); row.appendChild(prevBtn);
  quizEl.appendChild(row);
}

// Initialise
load();
render();
</script>
</body>
</html>
